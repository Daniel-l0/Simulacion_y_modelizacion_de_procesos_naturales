[MÚSICA] Por último les presentaré un ejemplo real que es una aplicación de esta simulación para investigar como nuestro vínculo con la erupción de un volcán. Así que cuando la gente piensa en erupción de un volcán y como de, normalmente piensan en la lava y el magma, la lava fluyendo pero no es el problema más peligroso para el ser humano porque los flujos de lava son realmente lentos. Hay muchos fenómenos más peligrosos y uno de ellos es el balístico, es decir, enormes trozos de magma o rocas que estaban dentro del conducto del volcán que se fragmentan y son expulsados con curva parabólica característica. Y esos trozos de magma son la mayoría de las veces pequeños, pero pueden ser grandes o realmente grandes. Por ejemplo, aquí puede ver una imagen nocturna de una erupción al norte de Sicilia. Y puede ver la lava fluyendo por el lado del respiradero del volcán. Pero también se ve esa especie de penacho formado por partículas de un trozo de magma que brillan en rojo y amarillo. Y se puede ver que siguen trayectorias realmente cercanas a las parábolas. Tiene usted una especie de haz de parábolas juntas saliendo del volcán. En esta erupción que se representa aquí puede ver que las bombas, llamamos normalmente bombas a estas partículas balísticas, pero las bombas no se alejan mucho del volcán. Pero de hecho, pueden, pueden aterrizar a varios cientos de metros de distancia. Por ejemplo, ese es un campo en la ladera de un volcán en Hawai, y puede ver que tiene partículas de diferente tamaño que se depositaron en el suelo cubriendo un gran espacio. Aquí por ejemplo puede ver dos enormes ejemplos de bombas volcánicas balísticas o volcánicas que cayeron, ese es otro volcán en Sicilia, es el volcán. Y puede ver que esta bomba puede ser bastante grande en tamaño. Aquí puede ver en la foto de la derecha a la [INAUDIBLE] quien fue la investigadora principal. Hizo su doctorado sobre el tema. Y esta bomba no sólo son enormes y realmente pesadas, pueden pesar varias ciudades, sino que también son realmente calientes y sí pueden superar los 700 grados. Así que si caen en las casas probablemente destruirán los tejados y provocarán un incendio por todas partes. Así que intentar predecir cuáles son las zonas alrededor del volcán donde puede caer esta bomba es un paso importante para predecir todos los resultados que pueden afectar a las personas que viven alrededor de los volcanes. Si suponemos que las bombas son esferas y despreciamos la fricción con el aire, despreciamos la fuerza directa. Podemos describir muy fácilmente el movimiento de la bomba dando a su posición una velocidad, un radio y una masa. Y la bomba seguirá un movimiento simple, uniformemente acelerado. De nuevo, eso es claramente física preuniversitaria que nos permite predecir la ubicación de la bomba en cada marca de tiempo en el futuro o dado que es una parábola incluso en el pasado. Y también podemos utilizar esta ecuación de movimiento realmente simple para detectar cuándo aterrizará la bomba en el suelo, cuándo se depositará la bomba es simplemente cuándo. Por ejemplo, si consideramos islas volcánicas, donde el único terreno, el terreno más significativo es el propio cono del volcán. Entonces, podemos considerar que el resto de la isla está cerca del nivel del mar, cero. Entonces, cuando la altitud de la bomba llegue a cero podemos decir que en ese momento se depositará. Pero, también podríamos intentar utilizar este enfoque para detectar las colisiones entre bombas porque algunos científicos han publicado datos en los que una trayectoria de la bomba se desvía durante su tiempo en el aire. Y así puede surgir de las colisiones entre bombas. Así que en nuestra investigación, queríamos investigar cómo estas colisiones son capaces de propagarse y cuánto son capaces de propagar la ubicación de una bomba en el suelo. Dónde impactará la bomba debido a la colisión. Y es bastante fácil detectarlas porque, de nuevo, se trata de una simple parábola, así que podríamos utilizar la siguiente condición para detectar la colisión. Así que primero simplemente el cuadrado de la distancia entre dos bombas en un momento dado es la resta de los vectores de posición, y luego lo multiplicamos por sí mismo para obtener el cuadrado del num. Y si este número es igual a la suma de los radios de ambas bombas al cuadrado, significa que si las bombas apenas se tocan están en colisión. Así que también podríamos resolver esta nueva ecuación cuadrática para intentar encontrar el punto en el tiempo en el que la bomba colisionará. Por supuesto una ecuación cuadrática, por lo que puede tener solución cero, significa que la bomba no colisionará, sólo una, o incluso dos. Porque las dos prabolas pueden cruzarse en dos puntos. De nuevo, aquí si tenemos en cuenta todas las posibles colisiones no hay forma de tener una solución analítica. Y podríamos tener una solución en tiempo continuo moviendo cada bomba de aire un ligero delta t, un ligero paso de tiempo, y luego comprobar todas las posibles colisiones de todos los pares de partículas para ver si están colisionando. O quizás utilizando alguna estructura de datos más interesante para intentar utilizar la que ha visto en dinámica molecular. Pero en ese caso, de nuevo la colisión será bastante infrecuente porque el espacio es grande, y las bombas, incluso grandes no lo son tanto. Así que la colisión será poco común, la mayoría de las veces, las bombas seguirán una simple parábola y se depositarán. Entonces aquí, la simulación de eventos discretos parece, realmente, un buen candidato para eso, y así es como solíamos modelar ese tipo de problema. De nuevo, los estados son realmente fáciles. Para cada bomba mantenemos su velocidad, su posición, el radio y la masa. Si vamos en el tiempo simplemente seguimos la parábola dada por la ecuación para encontrar su nueva posición. Y luego mantenemos dos listas, primero una lista con todas las partículas aerotransportadas, es decir la partícula que descansa en el aire y que se depositará más tarde. Y mantenemos una lista con todas las bombas que ya están depositadas porque eso es lo que nos interesa también. Al final de la simulación queremos tener un mapa y entender dónde se depositaría la bomba. En ese caso, queremos comparar cuál es el papel de las colisiones. En los eventos, tenemos tres tipos de eventos. En primer lugar, la erupción cada vez que hay una erupción hay una explosión. Podemos generar una o más bombas. Así que asociamos cada evento de erupción con una distribución. Hay muchos volcanes con, cuando entran en erupción de hecho tienen varios estallidos que pueden estar muy próximos en el tiempo y tendrán, no sé, durante un minuto un centenar de esos estallidos y cada estallido son, bombas que son expulsadas. Así que cada uno de esos estallidos, en ese caso, será un evento de erupción. Así que, la erupción puede crear una o más bombas. Está asociada a una distribución estadística que nos permitirá dibujar una nueva bomba de acuerdo con la observación empírica de la eyección de bombas. Y esta distribución nos permitirá dibujar el tamaño de las bombas, su masa y densidad, la velocidad inicial, etc. Pero los otros dos sucesos que nos interesan son la colisión primero. La colisión entre dos bombas, entre b1 y b2. Así que este suceso significa un tiempo(t). b1 chocará con b2. El último evento es suelo, significa que en el tiempo t, la bomba b1 chocará contra el suelo. Es interesante ver que cada evento está relacionado con cero, una o dos bombas. Así que erupción a bomba cero porque todavía no existe cuando ocurre el evento, que existirá justo después. Colisión está relacionado con dos bombas, porque y tierra a uno. Vamos a utilizar que para limpiar la cola en la medida en que simular el sistema. Así que el viejo código aquí, toda la parte interesante del código se oculta dentro de la acción de los eventos. Y de hecho, eso es lo más importante que hay que definir cuando esté ejecutando su propia simulación de DS es asegurarse de entender exactamente lo que deben hacer la mayoría de las acciones. Y lo ideal es que ponga toda la lógica posible ahí, porque entonces sabrá exactamente dónde encontrarla. Y es bastante fácil de depurar, porque cada acción tendrá un efecto que quizás no sea determinista pero sí predecible sobre una parte del estado. Así que puede depurar y pensar en sus eventos de acción por separado y eso hace que su código de colas sea más fácil. Así que utilizando el mismo formalismo que le he mostrado con la simulación de tráfico, le presentaré cada evento. En primer lugar su erupción, ¿qué hacemos cuando hay una erupción? En primer lugar, hacemos que cada bomba de aire se adelante al momento del evento. Entonces, en el momento dado o el estado, tenemos una lista de particulas aereas y todas ellas fuera de posicion y velocidad. Asi que se puede imaginar que estan en el aire, tienen una direccion, etc., pero están congeladas. Así que, tan pronto como tengamos un evento, sabemos que nada apareció antes, nada significativo, así que podemos hacer que toda la partícula salte a la próxima vez. Así que todas las bombas avanzarán al mismo tiempo. Y entonces podríamos procesar el evento. Así que lo primero que hay que hacer es este bucle de aquí. Para cualquier bomba, para cada bomba en la lista de bomba aérea, saltamos al tiempo, hacemos que esta bomba actualice su posición indicada para que corresponda al tiempo del evento. Entonces podemos generar las nuevas bombas usando la distribución, esta variable bs. Y entonces para cada bomba en bs, lo primero que podemos calcular es el tiempo de posición con la función, el tiempo de posición, simplemente resolviendo la ecuación cuadrática. Y metemos en la cola un nuevo evento que es la bomba, b1, que chocará contra el suelo en el tiempo td. Y entonces para cada bomba ya en el aire, intentaremos calcular el tiempo de colisión entre b1 y b2. Así que aquí quizás nunca colisionen. Así que quizás que de hecho tc no sea un número, así que en ese caso tenemos que ignorarlo. Y si hay dos posibles tiempos de colisión porque de nuevo estamos considerando la intersección entre dos ecuaciones cuadráticas así que podemos tener dos soluciones diferentes en ese caso. Simplemente tomaremos la siguiente en el orden del tiempo, que no está en el pasado, pero la tomaremos. Y insertamos todo eso. Así que la idea es que, en primer lugar, para cada nueva bomba, sabemos exactamente cuándo caerá al suelo y luego sabremos cuándo colisionará con otras partículas. Por supuesto, eso son suposiciones porque las otras partículas podrían colisionar antes y entonces cambiar toda la trayectoria, pero consideramos que, para la imagen dada, eso es lo que podría ocurrir en el futuro. Entonces, podemos hacer el mismo tipo de proceso para los demás sucesos. Así que para una colisión entre las bombas b1 y b2. En primer lugar, de nuevo, tenemos un bucle para estar seguros de que todas las partículas llegan a este punto en el tiempo, ya que sabemos que antes no había nada significativo. Y podemos limpiar la cola. Significa que como la partícula b1 y b2, la bomba de b1 y b2 colisionarán, significa que cambiarán de trayectoria. Así que todos los sucesos relacionados con b1 o con b2 en el futuro deberían ser invalidados, porque cambiarán de trayectoria y por lo tanto tendríamos que volver a calcular cuándo después de este cambio de trayectoria tocarán el suelo y si colisionarán con otras bombas. Así que en ese caso, si b1 y b2 colisionan, en primer lugar tenemos que hacer el salto al momento correcto para limpiar la cola como le dije. Y luego tenemos que volver a calcular todo sobre esta partícula porque cambiarán de trayectoria, así que nuevo tiempo de deposición. Y para cada una de estas partículas también tenemos que, de nuevo, compararlas con todas las partículas en el aire para encontrar la siguiente colisión posible. Es lo mismo para los eventos de suelo. Así que cuando una partícula golpea el suelo, sabemos que todas las partículas pueden saltar en tiempo hasta ese punto porque nada era significativo antes. Y podemos simplemente eliminar de la cola todas las demás partículas de eventos porque golpeó el suelo, así que no se moverá de nuevo. Y finalmente, actualizamos la lista de bombas aéreas. Retiramos la partícula depositada de la bomba de aire y la añadimos a la lista de partículas depositadas. Así que los eventos fueron bastante simples. Aquí tenemos un ejemplo de evolución. Así que aquí tenemos tres, cuatro eventos representados por círculos rojos. El primero está en el respiradero del volcán ocurrió en tiempo antes en la erupción. Así que imaginemos que estamos en esta fase de la evolución y cuando la erupción tenga lugar, tenemos que calcular las posibles colisiones y eventos de deposición del suelo. Por supuesto no pueden ocurrir todos. Pero podemos generarlos todos, ponerlos en la cola, simplemente el primero será seleccionado. Entonces aquí, por supuesto, colisionarán antes de tocar el suelo. Así que sabemos que podemos saltar el tiempo de simulación hasta este punto y cambiará la trayectoria, por ejemplo así, y podríamos computar un nuevo suelo, una nueva colisión para estas dos en concreto. La otra partícula caerá lejos de la isla, así que no computaremos su suelo. Pero haciendo así podemos simplemente tener una lista especulativa de posibles eventos y ya que saltamos al siguiente entonces ignoraremos todos los demás limpiando la cola cada vez que se modifique una trayectoria. Eso ha funcionado muy bien, así que eso es primero las huellas de las partículas en movimiento. Así que a la izquierda se puede ver un ejemplo de erupción sin colisión y a la derecha exactamente el mismo parámetro pero teniendo en cuenta la colisión. Y es interesante ver cómo el haz de parábola pero algunos de ellos parece más extendido. Y si tratamos de analizar lo que sucede con y sin colisiones. Así que, sin colisiones la simulación correspondiente a la imagen de la izquierda en las diapositivas anteriores. Cada impacto aquí se representa con un punto verde, y la simulación con colisión cada impacto se representa con un punto rojo o azul. Los puntos rojos son bombas que efectivamente colisionaron y los azules son bombas que podrían haber colisionado pero no lo hicieron. Y lo que es interesante ver es que de hecho la mayoría de las bombas no se ven afectadas por la colisión pero cuando lo están hay una posibilidad de que el radio aumente. Eso significa que el simple análisis de sólo la velocidad inicial de las bombas y su ángulo no puede explicarnos exactamente cuál es el radio crítico en el que tal cosa es posible. Y la colisión podría afectar a los resultados. Si le interesa ese ejemplo, le recomiendo que lea este bonito artículo de Tsunematsu et al., que se publicó recientemente en Computers Geosciences. Y por último me gustaría dar las gracias a estos dos autores por la imagen que les mostré en mi introducción. Con esto termina esta conferencia de la séptima semana sobre simulación de eventos discretos. Gracias por su atención, espero que hayan disfrutado con este tema. [MUSICA]